(this["webpackJsonpcord-19-ui"]=this["webpackJsonpcord-19-ui"]||[]).push([[0],{208:function(e,t,n){e.exports=n.p+"static/media/VespaIcon.aefa1e1f.png"},209:function(e,t,n){e.exports=n.p+"static/media/VespaLogoWhite.2fad86a7.png"},231:function(e,t,n){e.exports=n(394)},236:function(e,t,n){},394:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(49),c=n.n(l),o=(n(236),n(237),n(38)),i=n(28),s=n(16),u=n(17),m=n(216),d=n(415),h=n(408),g=n(40),f=n(404),E=n(63);var p=function(e){let t=e.to,n=Object(E.a)(e,["to"]);return"download"in n?r.a.createElement("a",Object.assign({},n,{href:t}),n.children):!t||t.startsWith("http")||t.startsWith("/api/")?r.a.createElement("a",Object.assign({target:"_blank",rel:"noopener noreferrer"},n,{href:t}),n.children):r.a.createElement(o.a,Object.assign({to:t},n))};function b(){const e=Object(s.a)(["\n  &&& {\n    height: 64px;\n    margin: 0;\n\n    border-bottom: 1px solid rgba(63, 157, 216, 0.25);\n\n    .item.header {\n      font-weight: bold;\n      font-size: 1.4em;\n    }\n\n    .item,\n    .item > a,\n    .item > a:not(.ui) {\n      color: white;\n      font-weight: bold;\n    }\n\n    .item > a:hover {\n      color: #ffc43c;\n    }\n\n    .item:last-child {\n      padding-right: 0 !important;\n      margin-right: 0 !important;\n    }\n\n    .ui.image {\n      width: 100px;\n    }\n\n    span {\n      color: #ffc43c;\n    }\n\n    .dropdown.item .menu {\n      background: #005a8e;\n      box-shadow: none;\n    }\n  }\n"]);return b=function(){return e},e}function v(){const e=Object(s.a)(["\n  background-color: #005a8e;\n  border-bottom: 2px solid rgba(255, 255, 255, 0.2);\n  a {\n    cursor: pointer;\n    font-weight: 600;\n  }\n"]);return v=function(){return e},e}const j=Object(u.a)(i.a)(v()),O=Object(u.a)(m.a)(b()),y=r.a.createElement(p,{to:"/"},r.a.createElement("span",null,"CORD-19")," Search and Navigate"),w=[{content:r.a.createElement(p,{to:"https://github.com/vespa-engine/cord-19/blob/master/cord-19-queries.md"},"API")},{content:r.a.createElement(p,{to:"https://github.com/vespa-engine/cord-19/blob/master/README.md"},"Open source")},{content:r.a.createElement(p,{to:"https://github.com/vespa-engine/cord-19/blob/master/README.md#Contact"},"Contact us")}];function x({children:e}){return r.a.createElement(O,{secondary:!0,inverted:!0,fluid:!0},r.a.createElement(m.a.Item,{header:!0,fitted:!0},y),e)}function S(){return r.a.createElement(d.a,d.a.onlyMobile,r.a.createElement(x,null,r.a.createElement(m.a.Menu,{position:"right"},r.a.createElement(h.a,{item:!0,icon:null,trigger:r.a.createElement(g.a,{name:"bars"})},r.a.createElement(h.a.Menu,{items:w},w.map((e,t)=>r.a.createElement(h.a.Item,Object.assign({key:t},e))))))))}function k(){return r.a.createElement(d.a,{minWidth:d.a.onlyTablet.minWidth},r.a.createElement(x,null,r.a.createElement(m.a.Menu,{position:"right"},w.map((e,t)=>r.a.createElement(m.a.Item,Object.assign({key:t},e))))))}var C=function(){return r.a.createElement(j,{sx:{paddingLeft:"0px",paddingRight:"0px"},width:1},r.a.createElement(f.a,null,r.a.createElement(k,null),r.a.createElement(S,null)))},_=n(219),A=n(409),I=n(215),P=n(104),D=n(34),F=n(406);function M(){const e=Object(s.a)(["\n  &&& {\n    font-size: 1.1rem;\n    margin: 0 auto;\n\n    input[type='text'] {\n      border-radius: 1.3rem;\n    }\n  }\n"]);return M=function(){return e},e}const R=Object(u.a)(F.a)(M());var q=function({onSearch:e,query:t=""}){const n=Object(a.useState)(t),l=Object(D.a)(n,2),c=l[0],o=l[1];Object(a.useEffect)(()=>{t!==c&&o(t)},[t]);const i=()=>e({query:c});return r.a.createElement(R,{onSubmit:i},r.a.createElement(F.a.Input,{fluid:!0,icon:r.a.createElement(g.a,{name:"search",link:!0,onClick:i}),placeholder:"Search...",className:"input",onChange:(e,{value:t})=>o(t),value:c}))};const z=/(?:^|\s)(\+?related_to:[0-9]+)(?:$|\s)/,L="all(\n     all(group(source) order(-count()) each(output(count())))\n     all(group(journal) max(10) order(-count()) each(output(count())))\n     all(group(authors.name) max(10) order(-count()) each(output(count())) as(author))\n     all(group(time.year(timestamp)) max(10) order(-count()) each(output(count())) as(year))\n     all(group(has_full_text) each(output(count())))\n   )".split("\n").map(e=>e.trim()).join(""),T=(e,t,n=!1)=>t.length?"+("+t.map(t=>n?"".concat(e,":[").concat(t,"]"):"".concat(e,':"').concat(t,'"')).join(" ")+")":null,Y=e=>Date.UTC(e,0,1)/1e3,N=e=>{const t=new URLSearchParams(window.location.search);for(var n=0,a=Object.entries(e);n<a.length;n++){let e=Object(D.a)(a[n],2),r=e[0],l=e[1];t.delete(r),Array.isArray(l)?l.forEach(e=>t.append(r,e)):l&&t.set(r,l)}e.hasOwnProperty("offset")||t.delete("offset"),t.entries().next().done||Object(o.c)("/search?"+t)},U=e=>{const t=e.get("query");if(!t)return null;const n=t.match(z);return n?n[1].split(":")[1]:null},V=()=>{const e=new URLSearchParams(window.location.search);return{query:e.get("query")||"",journal:e.getAll("journal"),source:e.getAll("source"),year:e.getAll("year"),author:e.getAll("author"),has_full_text:e.getAll("has_full_text"),ranking:e.get("ranking"),fieldset:e.get("fieldset"),relatedId:U(e)}};var H=n(208),W=n.n(H),B=n(144),J=n(209),G=n.n(J);function K(){const e=Object(s.a)(["\n  &&& {\n    width: 100%;\n    margin: auto 0 0;\n    background-color: ",";\n\n    .ui {\n      margin: 0;\n      border: 0;\n      color: white;\n      box-shadow: none;\n    }\n\n    .ui.segment {\n      padding: 1em 0em;\n    }\n\n    .ui.segment.sides {\n      width: 200px;\n      padding: 0;\n    }\n\n    a {\n      font-weight: bold;\n      color: white;\n    }\n\n    a:hover {\n      color: #ffc43c;\n    }\n\n    .ui.image {\n      width: 100px;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      right: 0px;\n      margin: auto;\n    }\n  }\n"]);return K=function(){return e},e}const $=Object(u.a)(i.a)(K(),({page:e})=>"main"===e?"transparent":"#005a8e");var Z=function({page:e=null}){return r.a.createElement($,{page:e},r.a.createElement(f.a,null,r.a.createElement(B.a.Group,{horizontal:!0,size:"small"},r.a.createElement(B.a,{basic:!0,textAlign:"main"===e?"center":"left"},r.a.createElement(p,{to:"https://pages.semanticscholar.org/coronavirus-research"},"COVID-19 Open Research Dataset (CORD-19)"),". 2020. Version 2020-04-10. Accessed 2020-04-11."," ",r.a.createElement(p,{to:"https://doi.org/10.5281/zenodo.3727291"},"doi:10.5281/zenodo.3727291"),r.a.createElement("br",null),"Copyright Verizon Media 2020 Licensed under"," ",r.a.createElement(p,{to:"https://github.com/vespa-engine/cord-19/blob/master/LICENSE"},"Apache License 2.0")),"main"!==e&&r.a.createElement(B.a,{className:"sides",basic:!0},r.a.createElement(p,{to:"https://vespa.ai"},r.a.createElement(I.a,{src:G.a}))))))};function Q(){const e=Object(s.a)(["\n  &&& {\n    min-height: calc(100vh - 130px);\n    color: white;\n    font-size: 1.1rem;\n    margin-top: 0;\n\n    .column {\n      padding: 0;\n    }\n\n    h1 {\n      font-size: 3.5rem;\n      font-weight: 300;\n    }\n\n    h4 {\n      font-size: 1.1rem;\n      margin: 3rem 0 0;\n    }\n\n    & .ui.list {\n      margin: 0.5rem 0;\n    }\n\n    .ui.form {\n      max-width: 800px;\n      padding: 0 2rem;\n    }\n\n    a {\n      color: #b3e5fc !important;\n      font-weight: 600;\n      font-weight: normal;\n    }\n\n    a:hover {\n      color: #ffc43c !important;\n    }\n  }\n"]);return Q=function(){return e},e}function X(){const e=Object(s.a)(["\n  background-image: linear-gradient(0deg, #98c1db 7%, #005a8e 100%);\n  min-height: calc(100vh - 66px);\n"]);return X=function(){return e},e}const ee=["+covid-19 +temperature impact on viral transmission",'basic reproduction numbers for covid-19 in +"south korea"',"Impact of school closure to handle COVID-19 pandemic",'+title:"reproduction number" +abstract:MERS','+authors.name:"Neil M Ferguson"','+("SARS-COV-2" "coronavirus 2" "novel coronavirus")',"+chloroquine +(covid-19 coronavirus)"],te=Object(u.a)(i.a)(X()),ne=Object(u.a)(_.a)(Q());function ae(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Try searching for..."),r.a.createElement(A.a,null,Object(P.shuffle)(ee).slice(0,3).map((e,t)=>r.a.createElement(A.a.Item,{key:t},r.a.createElement(p,{to:"/search?query="+encodeURIComponent(e)},e)))))}function re(){return r.a.createElement(i.a,{my:4},r.a.createElement(I.a,{src:W.a,size:"tiny",centered:!0}),r.a.createElement(i.c,{mt:3},"This is an"," ",r.a.createElement(p,{to:"https://github.com/vespa-engine/cord-19/blob/master/README.md"},"open source application"," "),"on ",r.a.createElement(p,{to:"https://vespa.ai"},"Vespa.ai")),r.a.createElement(i.c,{mt:1},"The big data serving engine."))}var le=function(){return r.a.createElement(te,{width:1},r.a.createElement(ne,{verticalAlign:"middle",textAlign:"center"},r.a.createElement(_.a.Column,null,r.a.createElement("h1",{size:"huge"},"CORD-19 Search"),r.a.createElement(q,{onSearch:N}),r.a.createElement(ae,null),r.a.createElement(re,null))),r.a.createElement(Z,{page:"main"}))},ce=n(217),oe=n(410),ie=n(407),se=n(108),ue=n(107),me=n.n(ue);function de({first:e,middle:t,last:n}){if(!n)return e||t;const a=[e,t].filter(e=>e).join(" ").match(/(?:(?=^|\s)(\w)|([A-Z]))/g);return(a?a.join("")+" ":"")+n}function he(){const e=Object(s.a)(["\n  &&.icon {\n    margin: 0 0 0 0.5em;\n  }\n"]);return he=function(){return e},e}function ge(){const e=Object(s.a)(["\n  && {\n    box-shadow: none;\n    margin-bottom: 2em;\n\n    a {\n      color: #005a8e;\n    }\n\n    a:hover {\n      color: #1a7db6;\n    }\n  }\n\n  &.card {\n    width: 100%;\n  }\n\n  .header {\n    font-weight: bold;\n    padding: 5px;\n  }\n\n  &.card .meta {\n    font-size: 0.9em;\n    padding: 0 0.5em;\n    color: rgba(48, 48, 48, 0.5);\n\n    a.doi {\n      float: right;\n    }\n  }\n\n  .meta:after {\n    content: '';\n    display: table;\n    clear: both;\n  }\n\n  && .content {\n    padding: 0.3em 0.5em;\n    border: 0;\n  }\n"]);return ge=function(){return e},e}const fe=Object(u.a)(oe.a)(ge()),Ee=Object(u.a)(g.a)(he()),pe=/<hi>(.*?)<\/hi>/g,be=e=>e?e.replace(/<sep \/>/g,"\u2026").split(pe).map((e,t)=>t%2===0?e:r.a.createElement("b",{key:t},e)):null,ve=e=>{let t=e.onClick,n=Object(E.a)(e,["onClick"]);return r.a.createElement("a",{href:"#root",onClick:e=>{e.preventDefault(),t()}},n.children)};function je({text:e}){return r.a.createElement(ie.a,{content:e,trigger:r.a.createElement("span",null,r.a.createElement(Ee,{name:"question circle"}))})}function Oe({journal:e,timestamp:t}){const n=e?" (YYYY-MM-DD)":"YYYY-MM-DD";return r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Journal:")," ",e),t>0?r.a.createElement(me.a,{format:n,unix:!0,utc:!0},1e3*t):null)}function ye({doi:e}){return e?r.a.createElement(p,{className:"ui doi",to:e},e.replace("https://doi.org/","doi:")):null}function we({source:e,citations_count_total:t}){const n=t>0;return e||n?r.a.createElement("div",null,e&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Source: "),e),e&&n&&r.a.createElement(r.a.Fragment,null,", "),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Citations: "),t)):null}function xe({authors:e}){const t=Object(a.useState)(!1),n=Object(D.a)(t,2),l=n[0],c=n[1];if(!e)return null;const o=l||e.length<12?e.length:10;return r.a.createElement("div",null,r.a.createElement("b",null,"Authors: "),e.map(de).slice(0,o).join(", "),o<e.length?r.a.createElement(r.a.Fragment,null," ",r.a.createElement(ve,{onClick:()=>c(!0)},"and ",e.length-o," more")):null)}var Se=function({fields:{id:e,title:t,timestamp:n,journal:a,doi:l,abstract:c,abstract_t5:o,body_text:i,authors:s,source:u,citations_count_total:m},onSearchSimilar:d,isFieldSetAll:h}){const g=be(c),f=be(i),E=t.replace(pe,"$1");return r.a.createElement(fe,null,r.a.createElement(oe.a.Header,null,r.a.createElement(p,{to:"/article/".concat(e)},E)),r.a.createElement(oe.a.Meta,null,r.a.createElement(Oe,{journal:a,timestamp:n}),r.a.createElement(ye,{doi:l}),r.a.createElement(we,{source:u,citations_count_total:m}),r.a.createElement(xe,{authors:s})),(g||d)&&r.a.createElement(oe.a.Content,null,g&&r.a.createElement("div",null,r.a.createElement(ie.a,{position:"top center",content:"This is a dynamic summary of the abstract of the paper, showing the matched query terms and surrounding context.",trigger:r.a.createElement(se.a,{horizontal:!0},"Abstract")}),g),f&&r.a.createElement("div",null,r.a.createElement(ie.a,{position:"top center",content:"This is a dynamic summary of the body of the paper, showing the matched query terms and surrounding context.",trigger:r.a.createElement(se.a,{horizontal:!0},"Full Text")}),f),o&&r.a.createElement("div",null,r.a.createElement(se.a,{horizontal:!0},"Machine Generated Summary",r.a.createElement(je,{text:"This is a short summary of the abstract, generated using a Natural Language Processing Model (T5)."})),be(o)),d&&r.a.createElement(ve,{onClick:d},"Search for similar articles")))},ke=n(45),Ce=n(405),_e=n(413);function Ae(){const e=Object(s.a)(["\n  && {\n    display: block;\n    padding: 2px;\n    font-size: 0.9em;\n    label {\n      color: #303030;\n    }\n  }\n"]);return Ae=function(){return e},e}const Ie=[{name:"Source",field:"source"},{name:"Journal",field:"journal"},{name:"Published",field:"year"},{name:"Author",field:"author"},{name:"Full text",field:"has_full_text"}],Pe=Object(u.a)(Ce.a)(Ae());function De({name:e,field:t,values:n,onSearch:a}){if(!n||0===n.length)return null;const l=(e,{value:r,checked:l})=>{const c=n.filter(({value:e,checked:t})=>e===r?l:t).map(({value:e})=>e);a({[t]:c})};return r.a.createElement(F.a.Field,null,r.a.createElement("label",null,e),n.filter(({value:e})=>e.length>0&&!("year"===t&&"1970"===e)).map(({value:t,count:n,checked:a},c)=>r.a.createElement(Pe,{key:c,name:e,value:t,onChange:l,label:"".concat(t," (").concat(n,")"),checked:a})))}var Fe=function(e){let t=e.onSearch,n=Object(E.a)(e,["onSearch"]);const a=!0!==Object.values(n).flatMap(e=>e.map(({checked:e})=>e)).find(e=>e);return r.a.createElement("div",{id:"sidebar",className:"ui form",style:{backgroundColor:"#e6eff5"}},r.a.createElement(_e.a,{disabled:a,onClick:()=>t(Ie.reduce((e,{field:t})=>Object(ke.a)({},e,{[t]:[]}),{}))},"Clear all"),Ie.map(({name:e,field:a})=>r.a.createElement(De,{key:a,name:e,field:a,values:n[a],onSearch:t})))},Me=n(411);function Re(){const e=Object(s.a)(["\n  &&& {\n    width: 100%;\n    margin: 0;\n    .ui.message {\n      background: transparent;\n      box-shadow: none;\n    }\n    .ui.warning.message {\n      background: #fffaf3;\n    }\n    .ui.error.message {\n      background: #fff6f6;\n    }\n  }\n"]);return Re=function(){return e},e}const qe=Object(u.a)(B.a)(Re()),ze=({header:e,message:t})=>r.a.createElement(qe,{basic:!0,textAlign:"center"},r.a.createElement(Me.a,null,e&&r.a.createElement(Me.a.Header,null,e),r.a.createElement(Me.a.Content,null,t))),Le=({header:e,message:t})=>r.a.createElement(qe,{basic:!0,textAlign:"center"},r.a.createElement(Me.a,{error:!0},e&&r.a.createElement(Me.a.Header,null,e),r.a.createElement(Me.a.Content,null,t))),Te=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BACKEND_URL||"https://api.cord19.vespa.ai";function Ye(e,t){return Ne("GET",e,t)}function Ne(e,t,n){function r(e,t){return Object(ke.a)({},e,{},t)}t.startsWith("http")||(t=Te+t),(n=n||{}).method=e,n.credentials="same-origin";const l=()=>fetch(t,n).then(e=>e.ok?e:e.text().then(t=>{let n=t;try{const e=JSON.parse(t);"message"in e&&(n=e.message)}catch(a){}return Promise.reject({message:n,code:e.status})})).then(e=>{const t=e.headers.get("content-type");return!t||n.returnRaw?e:t.includes("application/json")?e.json():t.includes("text/plain")?e.text():e});let c=!1;return{promise:l,state:e=>{const n=e||0,o={url:t,loading:null,cancel:()=>{c=!0},response:null,error:null,version:n},i=Object(a.useReducer)(r,o),s=Object(D.a)(i,2),u=s[0],m=s[1];return t===u.url&&n===u.version||m(o),null===u.loading&&(m({loading:!0}),l().then(e=>{c||m({loading:!1,response:e,version:n})}).catch(e=>{c||m({loading:!1,error:e,version:n})})),Object(ke.a)({},u,{loading:null===u.loading||u.loading})}}}function Ue(){const e=Object(s.a)(["\n  &&& {\n    margin: 0.32em;\n    > span {\n      float: right;\n    }\n  }\n"]);return Ue=function(){return e},e}const Ve=u.a.div(Ue()),He=[{text:"title and abstract",value:"default"},{text:"title, abstract and full text",value:"all"}],We=[{text:"Vespa BM25",value:"bm25"},{text:"Vespa nativeRank",value:"default"},{text:"date",value:"freshness"}];function Be({id:e}){var t;const n=new URLSearchParams;n.set("yql","select title from sources * where id = ".concat(e,";"));const a=Ye("/search/?"+n.toString()).state(),l=a.loading,c=a.response,o=a.error;if(l)return r.a.createElement(ze,{message:"Loading..."});if(o)return r.a.createElement(Le,{message:o.message||"Failed to load article #".concat(e)});const i=null===c||void 0===c||null===(t=c.root)||void 0===t?void 0:t.children;return i?r.a.createElement(Ve,null,"Showing articles similar to"," ",r.a.createElement(p,{to:"/article/".concat(e)},i[0].fields.title)):null}var Je=function({totalCount:e,fieldset:t,ranking:n,onSearch:a,relatedId:l}){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve,null,e>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,e)," matches"),r.a.createElement("span",null,"Searching in"," ",r.a.createElement(h.a,{inline:!0,defaultValue:He.find(({value:e},n)=>t===e||!t&&0===n).value,options:He.map((e,t)=>Object(ke.a)({id:t},e)),onChange:(e,{value:t})=>a({fieldset:t})})," and sorting by ",r.a.createElement(h.a,{inline:!0,defaultValue:We.find(({value:e},t)=>n===e||!n&&0===t).value,options:We.map((e,t)=>Object(ke.a)({id:t},e)),onChange:(e,{value:t})=>a({ranking:t})}))),l&&r.a.createElement(Be,{id:l}))},Ge=n(417);function Ke(){const e=Object(s.a)(["\n  width: fit-content;\n  margin: 0 auto;\n"]);return Ke=function(){return e},e}const $e=u.a.div(Ke());var Ze=function({total:e,offset:t,onOffsetChange:n,numPerPage:a=10}){const l=Math.min(100,Math.floor((e+a-1)/a));return l<=1?null:r.a.createElement($e,null,r.a.createElement(Ge.a,{firstItem:null,lastItem:null,prevItem:null,nextItem:null,totalPages:l,defaultActivePage:1+t/a,onPageChange:(e,{activePage:t})=>n((t-1)*a)}))};function Qe(){const e=Object(s.a)(["\n  &&& {\n    font-size: 1rem;\n    width: 100%;\n    margin: 0.5em auto 0;\n    padding: 1rem 0;\n    display: flex;\n\n    #sidebar {\n      width: 30%;\n      max-width: 250px;\n      height: fit-content;\n      margin-right: 1em;\n      padding: 0.5em;\n      border-radius: 0.28571429rem;\n\n      .ui.button {\n        width: calc(100% - 1em);\n        padding: 0.78125rem 0.4rem;\n        line-height: 1.4285em;\n        border-radius: 1.3rem;\n        margin: 0 0.5em 0.5em;\n        background: rgba(0, 90, 142, 0.1);\n        color: #3f9dd8;\n      }\n    }\n\n    #search_results {\n      flex: 1;\n      margin-top: 0.5em; // Must match #sidebar top padding\n    }\n\n    #no_matches {\n      text-align: center;\n      margin: 2rem;\n    }\n  }\n"]);return Qe=function(){return e},e}const Xe=Object(u.a)(f.a)(Qe()),et=(e,t)=>e.replace(z," ").trim()+" related_to:"+t;function tt({query:e}){return r.a.createElement("div",{id:"no_matches"},r.a.createElement("h1",null,"\xaf\\_(\u30c4)_/\xaf"),r.a.createElement("br",null),"No matches for ",r.a.createElement("b",null,e))}function nt({articles:e,query:t,isFieldSetAll:n,loading:a,error:l}){return a?r.a.createElement(ze,{message:"Searching..."}):l?r.a.createElement(Le,{message:l.message||"Unknown search error..."}):0===e.length?r.a.createElement(tt,{query:t}):r.a.createElement(r.a.Fragment,null,e.map((e,a)=>r.a.createElement(Se,Object.assign({key:a},e,{isFieldSetAll:n,onSearchSimilar:()=>N({query:et(t,e.fields.id)})}))))}var at=function(){var e,t,n;const l=V(),c=(()=>{const e=V(),t=e.journal,n=e.source,a=e.year,r=e.author,l=e.has_full_text,c=a.map(e=>parseInt(e)).map(e=>Y(e)+";"+(Y(e+1)-1)),o=[T("journal",t),T("source",n),T("timestamp",c,!0),T("authors.name",r),T("has_full_text",l)].filter(e=>e).join(" "),i=new URLSearchParams(window.location.search),s=i.get("ranking"),u=i.get("fieldset");return["journal","source","year","author","has_full_text","ranking","fieldset"].forEach(e=>i.delete(e)),o&&i.set("filter",o),s&&i.set("ranking.profile",s),u&&i.set("model.defaultIndex",u),i.set("select",L),i})();c.set("type","any"),c.set("summary","short"),c.set("restrict","doc"),c.set("hits",10);const o=Ye("/search/?"+c.toString()).state(),i=o.loading,s=o.response,u=o.error,m=Object(a.useState)(),d=Object(D.a)(m,2),h=d[0],g=d[1],f=((null===s||void 0===s||null===(e=s.root)||void 0===e?void 0:e.children)||[]).sort(({id:e,relevance:t},{id:n,relevance:a})=>"group:root:0"===e?-1:"group:root:0"===n?1:a-t),E=Object(ce.a)(f),p=E[0],b=E.slice(1);Object(a.useEffect)(()=>{i||g(p)},[p,g,i]);const v=(null===s||void 0===s||null===(t=s.root)||void 0===t||null===(n=t.fields)||void 0===n?void 0:n.totalCount)||0,j=(null===h||void 0===h?void 0:h.children)?h.children.reduce((e,{label:t,children:n})=>(e[t]=n.map(({value:e,fields:n})=>({value:e,count:n["count()"],checked:l[t].includes(e)})),e),{}):{};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Xe,null,r.a.createElement(Fe,Object.assign({onSearch:N},j)),r.a.createElement("div",{id:"search_results"},r.a.createElement(q,Object.assign({onSearch:N},l)),r.a.createElement(Je,Object.assign({totalCount:v,onSearch:N},l)),r.a.createElement(nt,Object.assign({query:l.query,isFieldSetAll:"all"===l.fieldset},{articles:b,loading:i,error:u})),r.a.createElement(Ze,{total:v,offset:parseInt(c.get("offset"))||0,onOffsetChange:e=>N({offset:e})}))),r.a.createElement(Z,null))},rt=n(414),lt=n(418);function ct(){const e=Object(s.a)(["\n  &&& {\n    margin-top: 1rem;\n    margin-bottom: 1rem;\n  }\n"]);return ct=function(){return e},e}const ot=Object(u.a)(f.a)(ct());function it({authors:e}){return e?r.a.createElement(rt.a.Subheader,null,e.map(de).join(", ")):null}function st({journal:e,timestamp:t,source:n,license:a,doi:l}){const c=e?" (YYYY-MM-DD)":"YYYY-MM-DD",o=t?r.a.createElement(me.a,{format:c,unix:!0,utc:!0},1e3*t):null;return r.a.createElement(A.a,null,l&&r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,"Doi"),r.a.createElement(p,{to:l},l.replace("https://doi.org/",""))),e?r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,"Journal"),e," ",o):r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,"Date"),o),n&&r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,"Source"),n),a&&r.a.createElement(A.a.Item,null,r.a.createElement(A.a.Header,null,"License"),a))}function ut({title:e,abstract:t,abstract_t5:n,authors:a,doi:l,journal:c,timestamp:o,source:i,license:s}){return r.a.createElement(ot,null,r.a.createElement(rt.a,{as:"h1"},e),r.a.createElement(it,{authors:a}),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(rt.a,{as:"h3"},"Abstract"),r.a.createElement("p",null,t),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(rt.a,{as:"h3"},"Machine Generated Summary"),r.a.createElement("p",null,n))),r.a.createElement(st,{journal:c,timestamp:o,source:i,license:s,doi:l}))}function mt({id:e}){const t=new URLSearchParams;t.set("id",e),t.set("searchChain","related-ann"),t.set("summary","short"),t.set("ranking.profile","related-ann"),t.set("use-abstract",!0),t.set("hits",5);const n=Ye("/search/?"+t.toString()).state(),a=n.loading,l=n.response,c=n.error;return a?r.a.createElement(ze,{message:"Searching..."}):c?r.a.createElement(Le,{message:c.message||"Unknown search error..."}):(console.log(l),"children"in l.root?r.a.createElement(lt.a.Pane,null,r.a.createElement(r.a.Fragment,null,l.root.children.map((e,t)=>r.a.createElement(Se,Object.assign({key:t},e))),r.a.createElement(p,{to:"/search/?query=related_to:".concat(e)},"Show more"))):null)}function dt({citedBy:e,total:t,offset:n,onOffsetChange:a}){return r.a.createElement(f.a,null,e.slice(n,n+10).map(e=>r.a.createElement(ht,{key:e,id:e})),r.a.createElement(Ze,{total:t,offset:n,onOffsetChange:a}))}function ht({id:e}){const t=Ye("/document/v1/covid-19/doc/docid/".concat(e)).state(),n=t.loading,a=t.response,l=t.error;return n?r.a.createElement(ze,{message:"Loading..."}):l?r.a.createElement(Le,{message:l.message||"Failed to load article #".concat(e)}):(console.log(a),r.a.createElement(Se,a))}var gt=function({id:e}){const t=new URL(window.location),n=Ye("/document/v1/covid-19/doc/docid/".concat(e)).state(),a=n.loading,l=n.response,c=n.error;if(a)return r.a.createElement(ze,{message:"Loading..."});if(c)return r.a.createElement(Le,{message:c.message||"Failed to load article #".concat(e)});console.log(l);const i=Object(P.uniq)([...l.fields.cited_by||[],...(l.fields.citations_inbound||[]).map(e=>e.source_id).filter(e=>!isNaN(e))]),s=[{menuItem:"Similar articles",render:()=>r.a.createElement(mt,{id:l.fields.id})},{menuItem:{key:"citations",content:"".concat(i.length," citing articles"),disabled:0===i.length},render:()=>r.a.createElement(dt,{citedBy:i,offset:parseInt(t.searchParams.get("offset"))||0,total:i.length,onOffsetChange:e=>{t.searchParams.set("offset",e),Object(o.c)(t)}})}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ot,null,r.a.createElement(ut,l.fields),r.a.createElement(lt.a,{panes:s,defaultActiveIndex:t.searchParams.get("tab")||0,onTabChange:(e,n)=>{[...t.searchParams.keys()].forEach(e=>t.searchParams.delete(e)),t.searchParams.set("tab",n.activeIndex),Object(o.c)(t)}})),r.a.createElement(Z,null))};function ft(){const e=Object(s.a)(["\n  height: 80vh;\n"]);return ft=function(){return e},e}function Et(){const e=Object(s.a)(["\n  font-weight: 400;\n  color: #3f9dd8;\n"]);return Et=function(){return e},e}const pt=u.a.h2(Et()),bt=Object(u.a)(_.a)(ft());var vt=function({code:e=404}){const t=(e=>{switch(e){case 403:return"Sorry, you are not authorized to view this page.";case 404:return"Sorry, the page you were looking for does not exist.";case 500:return"Oops... something went wrong.";default:return"Unknown error - really, I have no idea what is going on here."}})(e);return r.a.createElement(bt,{textAlign:"center",verticalAlign:"middle"},r.a.createElement(_.a.Row,null,r.a.createElement(_.a.Column,{width:8},r.a.createElement(pt,null,t))))};var jt=function(){return r.a.createElement(i.b,{flexDirection:"column",minHeight:"100vh"},r.a.createElement(i.a,{width:1},r.a.createElement(C,null)),r.a.createElement(o.b,{primary:!1,component:r.a.Fragment},r.a.createElement(le,{path:"/"}),r.a.createElement(at,{path:"/search"}),r.a.createElement(gt,{path:"/article/:id"}),r.a.createElement(vt,{default:!0})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(jt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[231,1,2]]]);
//# sourceMappingURL=main.2372f0b7.chunk.js.map